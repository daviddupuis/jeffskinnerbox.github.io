Title: SendEmail as a Messaging Tool for the Raspberry Pi
Date: 2012-11-10 00:01
Category: Electronics
Tags: Raspberry Pi
Slug: sendemail-as-a-messaging-tool-for-the-raspberry-pi
Author: Jeff Irland
Image: email.jpg
Summary: SendEmail is a lightweight, completely command line based, SMTP email agent. I envision using this utility to email status reports/messages when generated by my Raspberry Pi.

In the projects I envision for the future, I'll be using my Raspberry Pi (RPi) as a gateway/server/controller for several other devices.  There is likely to be a need to generate status reports/messages and mail them out. It could be as simple as a notification that the deck lights have been turned-on. I don't need a full fledged mail client on the RPi to receive mail or manage a mailbox, just a command line utility to send email.  Also, I would like to send short text messages via (<a href="http://en.wikipedia.org/wiki/Short_Message_Service">SMS</a>) to my cell phone.  Linux does have a nice solution for this.

You do need an established email account with some email provider. I want to keep my personal email and my RPi's email separate  so I setup a special email account on gmail.  This will be used only by my Raspberry Pi's (or other intelligent devices). There <a href="http://www.e-eeasy.com/SMTPServerList.aspx">exist</a> some <a href="http://searchnetworking.techtarget.com/definition/open-relay">open SMTP relay</a> mail servers (mail servers that will not require a login nor a password) but many open mail relays have become unpopular and closed due to their exploitation by spammers and worms.
<h2>SendEmail</h2>
<a href="http://www.debianadmin.com/how-to-sendemail-from-the-command-line-using-a-gmail-account-and-others.html#more-706">SendEmail</a> is a lightweight, completely command line based, <a href="http://computer.howstuffworks.com/e-mail-messaging/email3.htm">SMTP email agent</a>. It is written in Perl and designed to be used on the command line, in bash scripts, Perl programs, within web sites, etc.

I installed SendEmail on my RPi via this command:

```shell
sudo apt-get install sendemail
```

<h2>Testing sendEmail</h2>
When I ran sendEmail the first time, it complained about some missing libraries.  I installed the missing libraries and this cleared the error.  Clearly, the sendEmail package needs some work since this dependency should have been taken care of by <code>apt-get</code>.

I ran it again using this command:

```shell
sendEmail -f pi@RedRPi -t <my_user_name>@verzion.net -u "Test Email from RedRPi" -m "My test message." -s smtp.gmail.com:587  -o tls=yes -xu <my_user_name> -xp <my_password>
```

With this, sendEmail threw an error message:

```
invalid SSL_version specified at /usr/share/perl5/IO/Socket/SSL.pm line 332
```

I did a web search and found that this is a reported bug within sendEmail (bummer), but I also found a simple <a href="http://unix.stackexchange.com/questions/53065/invalid-ssl-version-specified-at-usr-share-perl5-io-socket-ssl-pm-line-332">patch</a> for the problem (lucky break).  I applied the fix, executed the command again, and succeeded in sending the email.

One of the key parameter used here is the <a href="http://en.wikipedia.org/wiki/SMTP">SMTP</a> <a href="http://www.xeams.com/smtprelay.htm">mail relay</a> specified in  "<code>-s smtp.gmail.com:587</code>".  In this case, Gmail uses port 587 for relay email.  The default port to use is 25 but not all email servers use this port.

Another key parameter is "<code>-o tls=yes</code>". This specifies that the <a href="http://en.wikipedia.org/wiki/Transport_Layer_Security">Transport Layer Security (TLS)</a> protocol will be used to provide communication security over the Internet.  This is important since your including a plain-text password in the command.<sup id="cite_ref-1"></sup>
<h2>SMS Messaging</h2>
Another messaging mechanism that I plan to use is Short Message Service (SMS).  To do this, you can use a <a href="http://en.wikipedia.org/wiki/SMS_gateway">SMS gateway</a> which will transform an email into an SMS message.  The down side is that there isn't a single gateway but <a href="http://en.wikipedia.org/wiki/List_of_SMS_gateways">one for each of the cellular carries</a>.

Here is an example for AT&amp;T cell phones:

```shell
sendEmail -f pi@RedRPi -t <cell_phone_number>@txt.att.net -u "Test Email from RedRPi" -m "My test message." -s smtp.gmail.com:587  -o tls=yes -xu <my_user_name> -xp <my_password>
```
