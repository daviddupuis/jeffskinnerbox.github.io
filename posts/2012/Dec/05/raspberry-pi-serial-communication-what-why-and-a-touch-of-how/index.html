<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>Raspberry Pi Serial Communication: What, Why, and a Touch of How - Jeff's Skinner Box</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link href="http://jeffskinnerbox.me/favicon.ico" rel="icon">

    <!-- Open Graph tags -->
            <meta property="og:type" content="article"/>
            <meta property="og:title" content="Raspberry Pi Serial Communication: What, Why, and a Touch of How"/>
            <meta property="og:url" content="http://jeffskinnerbox.me/posts/2012/Dec/05/raspberry-pi-serial-communication-what-why-and-a-touch-of-how/"/>
            <meta property="og:description" content="In this article, I explore the serial communication options supported by the Raspberry Pi, under what situations would you use them, and how do you use them."/>

    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://jeffskinnerbox.me/theme/css/bootstrap.flatly.min.css" type="text/css"/>

    <!-- Font Awesome and Google Fonts -->
    <link href="http://jeffskinnerbox.me/theme/css/font-awesome.min.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Knewave' rel='stylesheet' type='text/css'>

    <link href="http://jeffskinnerbox.me/theme/css/pygments/native.css" rel="stylesheet">
        <link href="http://jeffskinnerbox.me/theme/css/typogrify.css" rel="stylesheet">
    <link rel="stylesheet" href="http://jeffskinnerbox.me/theme/css/style.css" type="text/css"/>

</head>

<body>
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://jeffskinnerbox.me/" style="font-family: Knewave, cursive; font-size: 48px; color: #FFFFFF">
Jeff's Skinner Box&nbsp;            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="http://jeffskinnerbox.me/pages/about-me.html">
                             About&nbsp;Me
                          </a></li>
                    <li><a href="/index.html">Blog</a></li>
                    <li><a href="/pages/open-notebook.html">Open Notebook</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="http://jeffskinnerbox.me/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
        <!-- GitHub Ribbon - https://github.com/blog/273-github-ribbons -->
        <a href="https://github.com/jeffskinnerbox/jeffskinnerbox.github.io/tree/source" target="_blank">
            <img style="position: absolute; top: 0; left: 0; border: 0;" src="https://github-camo.global.ssl.fastly.net/82b228a3648bf44fc1163ef44c62fcc60081495e/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f6c6566745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_left_red_aa0000.png">
        </a>
</div> <!-- /.navbar -->

<div class="container">
    <div class="row">
        <div class="col-sm-9">

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://jeffskinnerbox.me/posts/2012/Dec/05/raspberry-pi-serial-communication-what-why-and-a-touch-of-how/"
                       rel="bookmark"
                       title="Permalink to Raspberry Pi Serial Communication: What, Why, and a Touch of How">
                        Raspberry Pi Serial Communication: What, Why, and a Touch of&nbsp;How
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2012-12-05T00:01:00"> Wednesday  December 05, 2012</time>
    </span>



&nbsp;&nbsp;&nbsp;
<i class="fa fa-tags fa-lg"></i>
    <a class="btn btn-default btn-xs" href="http://jeffskinnerbox.me/tag/raspberry-pi/">Raspberry Pi</a>
    
</footer><!-- /.post-info -->                    </div>
<!-- Repost button -->
<!-- For more information - http://www.repost.us/ -->
<a class='rpuRepostUsButton' href='https://secure.repost.us/syndicate/create'>
    <img alt='Repost This' title='Repost this article to your website' src='http://static.1.rp-api.com/buttons/repostus_bttn_shrt_embed.png'/>
</a>                </div>
                <p>I started exploring how to get a <span class="caps">LCD</span> display operational with a Raspberry Pi (RPi).  I checked out two hardware configurations: the <a href="http://www.adafruit.com/products/181">bare bone <span class="caps">LCD</span> 16x2 display</a> driven by the <a href="http://iamsuhasm.wordpress.com/tutsproj/using-lcds/"><span class="caps">HD44780</span> chip set</a>, which takes 6 wires to operate,  and another configuration that uses a <a href="http://www.adafruit.com/products/772">Adafruit shield</a> that requires only 2 wires.  It quickly became clear to me that I knew very little about how the <span class="caps">LCD</span> display works (maybe not an important topic for me) and I didn&#8217;t fully understands the RPi&#8217;s serial communications capabilities (something I must fully understand).  Adafruit does give some nice tutorial that  provide instructions on how to get both configurations work on the RPi, but I don&#8217;t like blindly follow tutorials without having a deeper understanding of my options and the underlining hardware.   So what are the serial communication options supported by the Raspberry Pi, under what situations would you use them, and how do you use&nbsp;them?</p>
<p>So I did my research, and for the moment, I&#8217;m not going to concern myself about <span class="caps">LCD</span> displays but I will dive neck deep into understanding RPi serial communications.  I&#8217;ll return to the <span class="caps">LCD</span> display topic later.
<h2>The Raspberry Pi&nbsp;Board</h2>
As our first step, lets take a quick scan of the interfaces we have on RPi for moving data in and out.  The picture below labels the most prominent components on the RPi&nbsp;board.</p>
<p><center>
<a href="http://jeffskinnerbox.wordpress.com/2012/12/05/drive-a-16x2-lcd-with-the-raspberry-pi/raspberry-pi/#main" rel="attachment wp-att-870">
    <img class="aligncenter size-full wp-image-870" alt="raspberry-pi" src="/images/raspberry-pi.jpeg" width="545" height="454" />
</a>
</center></p>
<p>Of course, the &#8220;lead actor&#8221; on the RPi board is the Broadcom <span class="caps">BCM2835</span>, <a href="http://en.wikipedia.org/wiki/System-on-a-chip">System on a Chip (SoC)</a>.  Broadcom bills this chip as a &#8220;multimedia applications processor for advanced mobile and embedded applications that require the highest levels of multimedia performance&#8221;.  Maybe more importantly for the <span class="caps">DIY</span>/Hacker community is that all the <a href="http://www.raspberrypi.org/archives/2221">firmware running on the chip is now open source</a><strong>.</strong></p>
<p>There is another big chip, that being the <span class="caps">SMSC</span> <span class="caps">LAN9512</span>/LAN9512i <span class="caps">USB</span>  Hub &amp; Ethernet Controller.  This is the major work horse in getting data in/out of the RPi for <span class="caps">USB</span> peripheral devices and <span class="caps">IP</span>&nbsp;networking.</p>
<p>Now note that most of the board&#8217;s other large components are for data I/O.  Specifically, the <a href="http://en.wikipedia.org/wiki/Hdmi"><span class="caps">HDMI</span></a>, <a href="http://en.wikipedia.org/wiki/RCA_connector"><span class="caps">RCA</span> Video</a>, and <a href="http://en.wikipedia.org/wiki/Audio_jack">Audio Out</a> (3.5mm jack) are output only (at least for general purpose data communication perspective), and therefore, not part of our discussion.  On the other hand, the <a href="http://en.wikipedia.org/wiki/Usb"><span class="caps">USB</span></a> and <a href="http://en.wikipedia.org/wiki/Ethernet">Ethernet</a> ports, are powerful  and widely supported serial communication devices, but I will only lightly touch the <span class="caps">USB</span>. I want to focus on serial communication with simple/bare-bone devices, like an <span class="caps">LCD</span> 16x2 display, which generally are not interface via something as sophisticated at <span class="caps">USB</span> or Ethernet.  But the <span class="caps">USB</span> can be used to some for some types of device interfacing, so I will cover that as a final&nbsp;topic.</p>
<p>There are three other board components that concern themselves with data communications but will not be covered in this post:
<ul>
    <li><strong><span class="caps">JTAG</span> Header: </strong>The <a href="http://www.xjtag.com/support-jtag/jtag-high-level-guide.php"><span class="caps">JTAG</span></a> Header is used as a debug port. Embedded systems developer relies on debuggers communicating with chips via the <span class="caps">JTAG</span> to perform operations like single stepping and break-pointing.  In time, I suspect people will find ways to exploit these pins for both good &amp; evil, but for now, this is for the RPi hardware development community to&nbsp;use.</li>
</ul>
<ul>
    <li><strong><span class="caps">CSI</span> Camera Connector: </strong>The <a href="http://www.mipi.org/specifications/camera-interface">Camera Serial Interface (<span class="caps">CSI</span>)</a>  specification is a standard interface between a camera and a host processor for mobile device applications.  This will be where you&#8217;ll connect cameras and video devices to the&nbsp;RPi.</li>
</ul>
<ul>
    <li><strong><span class="caps">DSI</span> Display Connector: </strong>The <a href="http://www.mipi.org/specifications/display-interface">Display Serial Interface (<span class="caps">DSI</span>)</a> is a specification  aimed at reducing the cost of display sub-systems in a mobile device. This is commonly targeted at <span class="caps">LCD</span> and similar display technologies. RPi may be able to interface to some of these.  Some graphical <span class="caps">LCD</span>/<span class="caps">OLED</span> displays might be attached to it.  <span class="caps">DSI</span> would seem like a good candidate for implementing my <span class="caps">LCD</span> display but there is a problem.  It appears the <a href="http://www.chalk-elec.com/?p=1553"><span class="caps">DSI</span> isn&#8217;t supported</a> at this&nbsp;time.</li>
</ul>
This leaves one remaining board input/output component standing, that be the <a href="http://elinux.org/RPi_Low-level_peripherals">General Purpose Input/Output (<span class="caps">GPIO</span>)</a>.  On some electronics boards, <span class="caps">GPIO</span> pins have no special purpose defined, and some pins go unused by default.  The RPi developer has identified a handful of digital control lines and provided services on them for you to use.  By having these available can save you the hassle of having to arrange additional circuitry to provide them or implement functionality in&nbsp;software.</p>
<p><b>Raspberry Pi&#8217;s <span class="caps">GPIO</span> as a Data Bus</b>
The first thing to get your head around, is how is data moved around the RPi, or in any general purpose computer.  In the most general sense in electronics, a bus or data bus is used to move data words of any type from one place to another. Computing is based on data words made up of collections of data bits. These “words” can contain as few as four data bits and often much&nbsp;larger.</p>
<p>The task of a bus designer is to devise circuitry that passes these data words from one circuit to another.  These words can be communicated <a href="http://en.wikipedia.org/wiki/Serial_communication">serially</a>  (i.e. <a href="http://www.eeherald.com/section/design-guide/esmod7.html">serial communications</a>) or in <a href="http://en.wikipedia.org/wiki/Parallel_communication">parallel</a>.
<ul>
    <li><strong>Serial Bus:</strong> The least expensive method in terms of wire cost is to send the bits one at a time over a single pair of wires. This is called serial data transmission.  Data words start as sets of bits that exist in parallel. In order to ship these words on a serial basis they must be converted to a serial stream of bits at the transmit end and then reconverted to a parallel word at the receive end. The common name for the circuitry that does this conversion is a <a href="http://www.eetimes.com/design/analog-design/4207765/The-basics-of-SerDes--serializers-deserializers--for-interfacing">SerDes</a> circuit which stands for serializer/deserializer. Integrated circuits are more expensive when they have more pins. To reduce the number of pins in a package, many ICs use a serial bus to transfer data when speed is not important. Some examples of such low-cost serial buses include <a href="http://en.wikipedia.org/wiki/Serial_Peripheral_Interface">Serial Peripheral Interface (<span class="caps">SPI</span>)</a>, <a href="http://en.wikipedia.org/wiki/I%C2%B2C">Inter-Integrated Circuit<b> </b>(I²C)</a>, <a href="http://en.wikipedia.org/wiki/UNI/O"><span class="caps">UNI</span>/O</a>, and <a href="http://en.wikipedia.org/wiki/1-Wire">1-Wire</a>.</li>
</ul>
<ul>
    <li><strong>Parallel Bus:</strong> At some point, it is more cost effective to add a wire for each bit in the word and send it in parallel on a data bus. Parallel buses have a limited data rate and distance at which they can be reliably run (more so than a serial bus).  Some widely used parallel bus standards are <a href="http://en.wikipedia.org/wiki/Parallel_Bus_Interface">Parallel Bus Interface</a> (<span class="caps">PBI</span>), <a href="http://en.wikipedia.org/wiki/Conventional_PCI">Peripheral Component Interface</a> (<span class="caps">PCI</span>), <a href="http://en.wikipedia.org/wiki/Small_Computer_Systems_Interface">Small Computer Systems Interface</a> (<span class="caps">SCSI</span>), the <a href="http://en.wikipedia.org/wiki/VMEbus">VMEbus</a> used in instrumentation, the <a href="http://en.wikipedia.org/wiki/RDRAM">Rambus</a> interface used in memories, and&nbsp;others.</li>
</ul>
As the name implies, <span class="caps">GPIO</span> pins can be configured through software  to provide some specific function or purpose within the <a href="http://elinux.org/RPi_Low-level_peripherals">hardware device design</a>.  The <span class="caps">GPIO</span> pins connect directly into the core of the processor, and the Raspberry Pi developers implemented several <a href="http://elinux.org/RPi_BCM2835_GPIOs">alternate functions</a> for the <span class="caps">GPIO</span> pins.  Several are desirable because of the multiple standards and types of devices you may wish to interface.  On boot-up,  the RPi board <span class="caps">GPIO</span> is in alternate function state &#8220;<span class="caps">ALT0</span>&#8221; and will support <span class="caps">I2C</span>, <span class="caps">SPI</span>, and <span class="caps">UART</span>.  This is shown below:
<p style="text-align:center;">
    <a href="http://jeffskinnerbox.wordpress.com/2012/12/05/drive-a-16x2-lcd-with-the-raspberry-pi/raspberry-pi-rev-1-gpio-pin-out-2/#main" rel="attachment wp-att-885">
        <img class="aligncenter  wp-image-885" alt="Raspberry Pi (Rev 1) GPIO Pin Out" src="/images/raspberry-pi-rev-1-gpio-pin-out1.jpg" width="424" height="474" />
    </a>
</p>
It can be confusing to call the RPi&#8217;s whole 26 pin array <span class="caps">GPIO</span> and also some specific pins <span class="caps">GPIO</span>.   In reality, all the <span class="caps">GPIO</span> pins can be reconfigured to provide alternate functions. <a href="http://elinux.org/RPi_Low-level_peripherals">
</a></p>
<p>While <span class="caps">PCM</span> isn&#8217;t a topic for this posting, in the figure above, you&#8217;ll also see references to <span class="caps">PCM</span> on pins 18 <span class="amp">&amp;</span> 21.  <span class="caps">PCM</span> stands for <a href="http://en.wikipedia.org/wiki/Pulse-code_modulation">Pulse-code modulation</a> and is s a method used to digitally represent analog signals.  It is often used to control light intensity or motors.  RPi&#8217;s native <span class="caps">PCM</span> capabilities are not well documented but it appears that people have has some success.  Generally, to do anything useful, you need multiple <span class="caps">PCM</span> channels so people have resorted to adding <a href="http://learn.adafruit.com/adafruit-16-channel-servo-driver-with-raspberry-pi/overview">hardware</a> or <a href="https://projects.drogon.net/software-pwm-on-the-raspberry-pi/">software</a> to get the desired functionality from the RPi.  My guess is these RPi pins don&#8217;t have much of a future.
<h2><span class="caps">I2C</span>, <span class="caps">SPI</span>, <span class="caps">UART</span> &#8230; Say&nbsp;what?</h2>
Much has been lightly covered so far, including terms like <span class="caps">I2C</span>, <span class="caps">SPI</span>, and <span class="caps">UART</span>.  So what is the significance?  Well, <span class="caps">I2C</span>, <span class="caps">SPI</span>, and <span class="caps">UART</span> are the heart of our quest to understand RPi&#8217;s serial communications capability. Via their exposure on the <span class="caps">GPIO</span> pins, these capabilities are what can be used to integrate things like <span class="caps">LCD</span> displays to the RPi.  Now lets dive deeper into each one of them.
<h2>Universal Asynchronous Receiver/Transmitter (<span class="caps">UART</span>)</h2>
The <a href="http://www.lammertbies.nl/comm/info/serial-uart.html">Universal Asynchronous Receiver/Transmitter (<span class="caps">UART</span>)</a> takes bytes of data and transmits the individual bits in a sequential fashion. The device changes processor&#8217;s parallel information to serial data which can be sent on a communication line. A second <span class="caps">UART</span> (maybe on another processor)  can be used to receive the serial information. The <span class="caps">UART</span> performs all the tasks, timing, parity checking, etc. needed for the communication. The only extra devices attached are line driver chips capable of transforming the <a href="http://en.wikipedia.org/wiki/Transistor%E2%80%93transistor_logic"><span class="caps">TTL</span></a> level signals (0/5 volts) to line voltages (on <span class="caps">RS</span>-232 line this could be as +/- 25 volts) and vice&nbsp;versa.</p>
<p>Each <span class="caps">UART</span> contains a <a title="Shift register" href="http://en.wikipedia.org/wiki/Shift_register">shift register</a>, which is the fundamental method of conversion between serial and parallel forms. Serial transmission of digital information (bits) through a single wire or other medium is much more cost effective than parallel transmission through multiple wires.  The UARTs transmit/receive one bit at a time at a specified data rate (i.e. 9600bps, 115,200bps, etc.). This method of serial communication is sometimes referred to as <span class="caps">TTL</span> serial&nbsp;communications.</p>
<p><a href="http://en.wikipedia.org/wiki/Asynchronous_communication">Asynchronous transmission</a> allows data to be transmitted without the sender having to send a clock signal to the receiver. Instead, the sender and receiver must agree on timing parameters in advance and special bits are added to each word which are used to synchronize the sending and receiving units. When a word is given to the <span class="caps">UART</span> for Asynchronous transmissions, a bit called the &#8220;Start Bit&#8221; is added to the beginning of each word that is to be transmitted. The Start Bit is used to alert the receiver that a word of data is about to be sent, and to force the clock in the receiver into synchronization with the clock in the&nbsp;transmitter.</p>
<p>For a further description of synchronous and asynchronous line communications, check out this <a href="http://sangoma.com/support/tutorials/sync_n_async.html">tutorial</a>.
<h2>Raspberry Pi&#8217;s Mini-<span class="caps">UART</span></h2>
<em><span style="text-decoration:underline;">Warning</span>: Misleading information ahead - See Warren Gay&#8217;s comments.</em>
The Raspberry Pi actually has <a href="http://lavalink.com/2012/04/more-on-raspberry-pi-serial-ports/">two UARTs</a>. One <span class="caps">UART</span>  is part of the internal <span class="caps">ARM</span> architecture of the Broadcom <span class="caps">BCM2835</span> chip, in the core of the Raspberry Pi and not accessible externally.  The other <span class="caps">UART</span> is sometimes called the RPi&#8217;s &#8220;Serial Port&#8221; (even thou the <span class="caps">USB</span> supports serial communications, and therefore a serial port).  The serial port being reference here is serviced by a <span class="caps">UART</span>, sometime refereed to as the  “<a href="http://www.raspberrypi.org/wp-content/uploads/2012/02/BCM2835-ARM-Peripherals.pdf">Mini-<span class="caps">UART</span></a>&#8221; since it doesn&#8217;t appear to be very rich in functionality.  It is basically be used as a console port for access to the Raspberry Pi.  The <a href="http://www.techrepublic.com/blog/opensource/learn-to-use-a-serial-console-on-linux/157">serial console</a> is a convenient way to interact with the Raspberry Pi for debugging or your network is down and it is the destination of console messages (including boot-up messages).  From the <a href="http://elinux.org/RPi_Low-level_peripherals">Raspberry Pi pinout</a> and the <a href="http://elinux.org/RPi_Serial_Connection">eLinux wiki</a>, I can see that the serial port (aka Mini-<span class="caps">UART</span>) on the Pi is on <span class="caps">GPIO</span> Pin 14 (<span class="caps">TX</span>) and <span class="caps">GPIO</span> Pin 15 (<span class="caps">RX</span>):
<p style="text-align:center;">
    <a href="http://jeffskinnerbox.wordpress.com/2012/12/05/drive-a-16x2-lcd-with-the-raspberry-pi/mini-uart/#main" rel="attachment wp-att-888">
        <img class="aligncenter  wp-image-888" alt="Mini-UART" src="/images/mini-uart.jpg" width="473" height="253" />
    </a>
</p>
Since the <span class="caps">GPIO</span> pins give access to the Mini <span class="caps">UART</span>, you can establish a serial console, which can be used to log in to the Pi, and many other things.  However, normal console device communicate with -12V (logical “1″) and +12V (logical “0″) <span class="caps">RS</span>-232, which may just fry something in the 3.3V Pi. Even “<span class="caps">TTL</span> level” serial at 5V runs the same risk.  See <a href="http://codeandlife.com/2012/07/01/raspberry-pi-serial-console-with-max3232cpe/" rel="nofollow">this tutorial</a> for one example on how to build 3.3V to <span class="caps">RS</span>-232 levels converter with a <span class="caps">MAX3232CPE</span> and a few&nbsp;passive components.</p>
<p>You can reconfigure the RPi so that the Mini <span class="caps">UART</span> isn&#8217;t acting as a serial console and use it for outer purposes (e.g. communicate with an attached Arduino or Xbee).  <a href="http://www.irrational.net/2012/04/19/using-the-raspberry-pis-serial-port/">Using the Raspberry Pi’s serial port</a> requires some Linux reconfiguration and the abandonment of the serial console, and potentially some level conversion, but it could be useful. The Mini-<span class="caps">UART</span> pins to provide access to Linux&#8217;s <a href="http://www.raspberrypi.org/phpBB3/viewtopic.php?f=44&amp;t=13957">/dev/ttyAMA0</a> serial port.  To be able to use the serial port to connect and talk to other devices, the serial port console login needs to be disabled and the post &#8220;<a href="http://www.hobbytronics.co.uk/raspberry-pi-serial-port">Raspberry Pi and the Serial Port</a>&#8221; shows you&nbsp;how.</p>
<p>Again, keep in mind that <span class="caps">RX</span> and <span class="caps">TX</span> lines are available on the <a title="RPi Low-level peripherals" href="http://elinux.org/RPi_Low-level_peripherals">GPIOs</a> but operate at 3.3 volts. You&#8217;ll need a board or cable to<a href="http://www.adafruit.com/products/395"> level convert</a> 3.3 volt <span class="caps">UART</span> signals to connect with other devices (e.g. <span class="caps">RS</span>-232, <span class="caps">USB</span>).
<h2>Serial Peripheral Interface Bus (<span class="caps">SPI</span>) &#8212; aka 4-Wire Serial&nbsp;Bus</h2>
The <a href="http://www.eeherald.com/section/design-guide/esmod12.html">Serial Peripheral Interface Bus or <span class="caps">SPI</span></a> (pronounced as either S-P-I or spy) bus is a synchronous serial data link standard, named by Motorola, that operates in full duplex mode.  <span class="caps">SPI</span> is much simpler than <span class="caps">I2C</span>. Master and slave are linked by three data wires, usually called <span class="caps">MISO</span>, (Master in, Slave out), <span class="caps">MOSI</span> (Master out, Slave in), the <span class="caps">SCLK</span> clock line (sometimes called M-<span class="caps">CLK</span>), and an optional <span class="caps">SS</span> (Slave Select; sometimes known as the Chip Select <span style="text-decoration:underline;">or</span> <span class="caps">CS</span> line <span style="text-decoration:underline;">or</span> Chip Enable <span style="text-decoration:underline;">or</span> <span class="caps">CE</span> line) is the slave select or chip select line.  Its optional only if you have one slave, otherwise one or more <span class="caps">SS</span> lines are provided.  The Raspberry Pi has two <a href="http://en.wikipedia.org/wiki/Chip_select">Slave Select</a> lines: <span class="caps">CE0</span> and <span class="caps">CE1</span>.
<p style="text-align:center;">
    <a href="http://jeffskinnerbox.wordpress.com/2012/12/05/drive-a-16x2-lcd-with-the-raspberry-pi/spi-diagram-and-sescription/#main" rel="attachment wp-att-898">
        <img class="aligncenter  wp-image-898" alt="SPI Diagram and Sescription" src="/images/spi-diagram-and-sescription.jpg" width="436" height="363" />
    </a>
</p>
Usually the transfer sequence consist of driving the <span class="caps">SS</span> line low, sending X number of clock signals with the proper polarity and phase, then driving the <span class="caps">SS</span> line high to end the communication. As the clock signals are generated, data is transferred in both directions, therefore in a “transmit only” system the received bytes have to be discarded and in a “receive only” system a dummy byte has to be&nbsp;transmitted.</p>
<p>Many <span class="caps">SPI</span>-enabled ICs and Microcontrollers can cope with data rates of over 10MHz, so transfer is much faster than with <span class="caps">I2C</span>. Since it is <a href="http://www.fiberoptics4sale.com/wordpress/what-is-synchronous-transmission-and-asynchronous-transmission/">synchronous communications</a>, it is not limited to 8-bit words so you can send any message sizes with arbitrary content and purpose. The <span class="caps">SPI</span> interface does not require pull-up resistors, which translates to lower power consumption. The downside is that <span class="caps">SPI</span> normally has no addressing capability; instead, devices are selected by means of a <span class="caps">SS</span> signal which the master can use to enable one slave out of several connected to the <span class="caps">SPI</span> bus. If more than one slave exists, one chip select line is required per device, which can use precious <span class="caps">GPIO</span> lines on the Master.
<h2>Inter-Integrated Circuit (<span class="caps">I2C</span>) &#8212; aka 2-Wire Serial&nbsp;Bus</h2>
<a href="http://www.eeherald.com/section/design-guide/esmod11.html">Inter-Integrated Circuit or <span class="caps">I2C</span></a> (pronounced as either I-squared-C or I-2-C) is generically referred to as a &#8220;two-wire interface&#8221;.  It&#8217;s a multi-master serial single-ended computer bus invented by Philips that is used to attach low-speed peripherals to a motherboard, embedded system, cellphone, or other electronic&nbsp;device.</p>
<p><span class="caps">I2C</span> can be used to connect up to 127 nodes via a bus has two data wires, called <span class="caps">SCL</span> and <span class="caps">SDA</span>.  <span class="caps">SCL</span> is the clock line. It is used to synchronize all data transfers over the <span class="caps">I2C</span> bus. <span class="caps">SDA</span> is the data line. Of course, there is a third wire being ground. There may also be a 5 volt wire to distribute power to the devices. Both <span class="caps">SCL</span> and <span class="caps">SDA</span> lines are &#8220;open drain&#8221; drivers. What this means is that the chip can drive its output low, but it cannot drive it high.  For the line to be able to go high you must provide pull-up resistors to the 5v supply. There should be a resistor from the <span class="caps">SCL</span> line to the 5v line and another from the <span class="caps">SDA</span> line to the 5v line. The value of the resistors is not critical.  Anything from 1800 ohms to 47K ohms used (1.8K, 47K and 10K are common values). You only need one set of pull-up resistors for the whole <span class="caps">I2C</span> bus, not for each device, as illustrated below:
<p style="text-align:center;">
    <a href="http://jeffskinnerbox.wordpress.com/2012/12/05/drive-a-16x2-lcd-with-the-raspberry-pi/i2c-diagram-and-description-2/#main" rel="attachment wp-att-906">
    <img class="aligncenter  wp-image-906" alt="I2C Diagram and Description" src="/images/i2c-diagram-and-description1.jpg" width="436" height="293" />
    </a>
</p>
In theory the <span class="caps">I2C</span> bus can support multiple masters, but most micro-controllers can’t. A master is usually a microcontroller, although it doesn’t have to be. Slaves can be ICs or microcontrollers.  When the master wishes to communicate with a slave it sends a series of pulses down the <span class="caps">SDA</span> and <span class="caps">SCL</span> lines. The data that is sent includes an address that identifies the slave with which the master needs to interact. Addresses take 7 bits out of a data byte; the remaining bit specifies whether the master wishes to read (get data from a slave) or write (send data to a&nbsp;slave).</p>
<p>Some devices have an address that is entirely fixed by the manufacturer; others can be configured to take one of a range of possible addresses. When a micro-controller is used as a slave it is normally possible to configure its address by software, and for that address to take on any of the 127 possible values.  The address byte may be followed by one or more byes of data, which may go from master to slave or from slave to&nbsp;master.</p>
<p>When data is being sent on the <span class="caps">SDA</span> line, clock pulses are sent on the <span class="caps">SCL</span> line to keep master and slave synchronised. Since the data is sent one bit at a time, the data transfer rate is one eighth of the clock rate. The original standard specified a standard clock rate of 100KHz, and most <span class="caps">I2C</span> chips and micro-controllers can support this. Later updates to the standard introduced a fast speed of 400KHz and a high speed of 1.7 or 3.4 MHz.  The Arduino and Raspberry Pi can support standard and fast&nbsp;speeds.</p>
<p>The fast rate corresponds to a data transfer rate of 50K bytes/sec which is too slow for some control applications. One option in that case is to use <span class="caps">SPI</span> instead of <span class="caps">I2C</span>.
<h2>1-Wire &#8212; aka&nbsp;1-Wire Serial Bus</h2>
On a <a href="http://www.maximintegrated.com/products/1-wire/flash/overview/index.cfm">1-Wire </a>bus (sometime refered to as a  &#8221;MicroLan&#8221;), a single master device communicates with one or more 1-Wire slave devices over a single data line, which can also be used to provide power to the slave devices. Devices drawing power from the 1-wire bus are said to be operating inparasitic power mode.  When operating in parasite power mode, only two wires are required: one data wire, and ground. At the master, a 4.7k pull-up resistor must be connected to the 1-wire bus. With an external supply, three wires are required: the bus wire, ground, and power. The 4.7k pull-up resistor is still required on the bus wire.
<p style="text-align:center;">
    <a href="http://jeffskinnerbox.wordpress.com/2012/12/05/drive-a-16x2-lcd-with-the-raspberry-pi/1-wire-diagram-and-description/#main" rel="attachment wp-att-907">
        <img class="aligncenter  wp-image-907" alt="1-Wire Diagram and Description" src="/images/1-wire-diagram-and-description.jpg" width="436" height="211" />
    </a>
</p>
Each 1-Wire device contains a unique 64-bit  code, consisting of an 8-bit family code, a 48-bit serial number, and an 8-bit <span class="caps">CRC</span>. Before sending a command to a slave device, the master must first select that device using its code.
<h2>How do you use <span class="caps">I2C</span>, <span class="caps">SPI</span>, <span class="caps">UART</span>, or 1-Wire on the Raspberry&nbsp;Pi?</h2>
Now that we know the what <span class="amp">&amp;</span> why for serial communications options on the Raspberry Pi, how do we use them?  This topic deserves technical details and examples but this post has already run too long.  I&#8217;m likely to do some specific implementation in the future, but for now I&#8217;ll reference some sources of information on the&nbsp;web.</p>
<p>First, lets be clear about the RPi software distribution I&#8217;m using, since not all will be supporting all these serial communications options.  I&#8217;m using Adafruit&#8217;s <a href="http://learn.adafruit.com/adafruit-raspberry-pi-educational-linux-distro/occidentalis-v0-dot-2">Occidentalis</a> distribution (based on &#8220;Wheezy&#8221;) which comes with hardware <span class="caps">SPI</span>, <span class="caps">I2C</span>, and 1-wire support. In the Occidentalis distribution, Adafruit has included in the Linux <a href="http://en.wikipedia.org/wiki/Kernel_(computing)#Unix">kernel</a> the needed drivers. <span class="caps">SPI</span> and <span class="caps">I2C</span> has been implement on the <span class="caps">GPIO</span> pins as outline above.  RPi doesn&#8217;t have a predetermined <span class="caps">GPIO</span> pin assignment for 1-Wire, but Adafruit choose <span class="caps">GPIO</span> pin 4 for 1-Wire.  Note that this unassigned <span class="caps">GPCLK0</span> (General Purpose Clock Voltage)&nbsp;function.</p>
<p>Given you have the Occidentalis distribution, you can check on the installation of <span class="caps">I2C</span>, <span class="caps">SPI</span>, and 1-Wire via the following:
<ul>
<ul>
    <li>To validate <span class="caps">I2C</span>, connect any <span class="caps">I2C</span> device to power, ground, <span class="caps">SDA</span> and <span class="caps">SCL</span>. Then run  <code>sudo i2cdetect -y 0</code> to detect which addresses are on the bus. <a href="http://linux.die.net/man/8/i2cdetect"><code>i2cdetect</code></a> is a program to scan an <span class="caps">I2C</span> bus for devices.  Also, you can list the <span class="caps">I2C</span> device drivers via the command <code>ls /dev/<em>i2c</em></code>.  This illustrates that RPi supports two <span class="caps">I2C</span> buses, 0 and&nbsp;1.</li>
    <li>To validate <span class="caps">SPI</span>, the command <code>ls /dev/<em>spi</em></code> will list two <span class="caps">SPI</span> devices, one each for the 0 <span class="amp">&amp;</span> 1 <span class="caps">SS</span> lines.  To go further, use the  <a href="http://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git;a=blob_plain;f=Documentation/spi/spidev_test.c">spidev_test.c</a> tool described in <a href="http://www.brianhensley.net/2012/07/getting-spi-working-on-raspberry-pi.html">Getting <span class="caps">SPI</span> working on the Raspberry Pi</a>.</li>
    <li>Occidentalis implementation of 1-Wire isn&#8217;t done via a kernel installed driver but <a href="http://en.wikipedia.org/wiki/Bit_banging">bitbanged</a>.  Adafruit states that the implementation is  &#8221;<a href="http://learn.adafruit.com/adafruit-raspberry-pi-educational-linux-distro/occidentalis-v0-dot-1#one-wire-support">flakier than <span class="caps">SPI</span> or <span class="caps">I2C</span></a>&#8221; and they don&#8217;t have any tutorials.  Maybe 1-Wire should be shelved for&nbsp;now.</li>
</ul>
</ul>
There are some good RPi <span class="caps">SPI</span> <span class="amp">&amp;</span> <span class="caps">I2C</span> tutorials on <a href="http://learn.adafruit.com/">Adafruits</a>.  There are others on personal blogs but generally they are scares right now.
<h2>Attach Peripherals to the Raspberry&nbsp;Pi</h2>
Now that we know the in&#8217;s <span class="amp">&amp;</span> out&#8217;s of serial communications with the RPi, what can be done to make the physical aspects of interfacing the board easier.  Dealing with the <span class="caps">GPIO</span> pins on the board can be a pain.  One solution is the <a href="http://adafruit.com/products/914">Pi Cobbler</a> which plug the <span class="caps">GPIO</span> pins into a solderless breadboard via a ribbon cable.  My personal favorite is the <a href="http://picru.st/">Pi Crust</a>.  In this case, the confusing layout of  <span class="caps">GPIO</span> pins are much more clearly organized and supplied with more useful female headers.  A whole development environment will be supplied via <a href="http://piregistration.element14.com/signup.html?isRedirect=true">PiFace Digital and Gertboard</a> &#8230; when they become available.
<h2>The <span class="caps">USB</span> Serial&nbsp;Ports</h2>
As promised, the final topic is the <span class="caps">USB</span> port. The <span class="caps">USB</span> can be used for some types of device interfacing, particularly if you make it look like a simple serial port to the device.  The <a href="http://www.tldp.org/HOWTO/Serial-HOWTO-1.html">conventional serial port</a> (<span style="text-decoration:underline;">not</span> the newer <span class="caps">USB</span> port) is a very old I/O (Input/Output) port. It&#8217;s slow compared to newer <a href="http://www.necdisplay.com/Documents/WhitePapers/USB.pdf">Universal Serial Bus (<span class="caps">USB</span>)</a> serial devices, but conventional serial ports are still in use and many devices you’ll hook to your RPi will want to use them.  Until around 2006, most new desktop <span class="caps">PC</span>&#8217;s had one but has been largely replaced by the <span class="caps">USB</span>. Conventional serial ports are still widely used in embedded systems, but the RPi choose to use the <span class="caps">USB</span>.  Never the less, it is possible to put a conventional serial port device on the <span class="caps">USB</span> bus by using a Serial to <span class="caps">USB</span> Adapter <a href="http://www.adafruit.com/products/284">hardware</a> or <a href="http://www.adafruit.com/products/954">cables</a>.  This could be necessary for some of the hardware hacking you’ll do with an RPi.  (For example, I’ll be posting a project where I’ll use the RPi’s <span class="caps">USB</span> to talk to a XBee&nbsp;radio.)</p>
<p><span class="caps">USB</span> does synchronous communications (synchronous means that bytes are sent out at a constant rate one after another in step with a clock signal tick) and transmits in special packets like a network. Conventional serial ports are typically asynchronous (i.e. &#8220;not synchronous&#8221;). Just like a network, <span class="caps">USB</span> can have several devices physically attached to it, including serial ports. Each device on it gets a time-slice of exclusive use for a short time. A device can also be guaranteed the use of the bus at fixed intervals. One device can monopolize it if no other device wants to use&nbsp;it.</p>
<p>Under Linux, each and every hardware device, including <span class="caps">USB</span> ports, are treated as a file and call a <a href="http://en.wikipedia.org/wiki/Device_file">device file</a>.  A device file allows a user to access hardware devices, but shields the users from the technical details about the hardware. (This is unlike what we’ll see for the RPi <span class="caps">GPIO</span> interfaces where hardware level technical details must be address directly.) Under Linux, a conventional serial port will typically have a device file such as <code>/dev/ttyS0, /dev/ttyS1,</code> etc. but the <span class="caps">USB</span> serial ports will appear as <code>/dev/ttyUSB0, /dev/ttyUSB1,</code> etc.  When your device is plugged in, Linux assigns the filename as it sees fit and isn’t always predicable (<a href="http://hintshop.ludvig.co.nz/show/persistent-names-usb-serial-devices/">it doesn’t have to be this way</a>). If you need to know what device file your serial device is connected too (and your software often needs to know), using a combination of the commands <code>lsusb</code>, <code>dmesg</code>, and <code>grep</code>, plus some basic insight, will often do the&nbsp;trick.</p>
<p>The <a href="https://access.redhat.com/knowledge/docs/en-US/Red_Hat_Enterprise_Linux/6/html/Deployment_Guide/s2-sysinfo-hardware-lsusb.html"><code>lsusb</code></a> command can show you the hubs connected to your system, but you won&#8217;t necessarily see any entries in /dev until you plug something into it, and what that entry may be will be dependent upon the type of device you are plugging in.  The system doesn&#8217;t recognize new <span class="caps">USB</span> devices right away. It can take from a couple of seconds to as much as a minute.  If I plug my <a href="http://www.adafruit.com/products/70">Serial to <span class="caps">USB</span> Adapter cable</a>, using the <a href="http://linux.die.net/man/8/lsusb"><code>lsusb</code></a> command I can identify the cables .  Now using <code>dmesg</code>, and grepping for the &#8220;Manufacturer&#8221;, I can get the &#8220;<span class="caps">FTDI</span>&#8221;.  Now I <code>grep</code> again for &#8220;<span class="caps">FTDI</span>&#8221; to get the device file name &#8220;<code>ttyUSB0</code><span class="dquo">&#8220;</span>.  This is all illustrated&nbsp;below:</p>
<p><center>
<a href="http://jeffskinnerbox.wordpress.com/2012/12/05/drive-a-16x2-lcd-with-the-raspberry-pi/lsusb-and-dmesg-2/" rel="attachment wp-att-1063">
    <img class="aligncenter size-full wp-image-1063" alt="lsusb and dmesg" src="http://jeffskinnerbox.files.wordpress.com/2012/12/lsusb-and-dmesg1.jpg" width="500" height="242" />
</a>
</center></p>
            </div>
            <!-- /.entry-content -->
    <hr />
    <section class="comments" id="comments">
        <h2>Comments</h2>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'jeffskinnerbox'; // required: replace example with your forum shortname
            var disqus_identifier = 'raspberry-pi-serial-communication-what-why-and-a-touch-of-how';
            var disqus_url = 'http://jeffskinnerbox.me/posts/2012/Dec/05/raspberry-pi-serial-communication-what-why-and-a-touch-of-how/';
            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3 well well-sm" id="sidebar">

<aside>
    <section>
        <ul class="list-group list-group-flush">
                <div style="text-align: center;">
                    <h3><a href="http://jeffskinnerbox.me/pages/about-me.html" style="font-family: Knewave, cursive; font-size: 18;">My Electronics Projects And Other Diversions</a>
                    <img class="img-rounded" src="http://jeffskinnerbox.me/extra/frustrated-engineer.jpg" alt="Side Bar Picture" height="100%" width="100%">
                </div>

            <li class="list-group-item"><a href="http://jeffskinnerbox.me/categories.html"><h4><i class="fa fa-folder-open fa-lg"></i><span class="icon-label">Categories</span></h4></a>
            </li>

            <li class="list-group-item"><a href="http://jeffskinnerbox.me/tags.html"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
            </li>    

            <li class="list-group-item"><a href="http://jeffskinnerbox.me/index.html"><h4><i class="fa fa-file-text fa-lg"></i><span class="icon-label">Recent Posts</span></h4></a>
            </li>

            <li class="list-group-item"><a href="http://jeffskinnerbox.me/pages/open-notebook.html"><h4><i class="fa fa-book fa-lg"></i><span class="icon-label">Open Notebook</span></h4></a>

            <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
                <ul class="list-group" id="links">
                    <li class="list-group-item">
                        <a href="/pages/scratch-pad.html" target="_blank">
                            Scratch Pad
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/pages/linux-python-packages-for-my-raspberry-pi.html" target="_blank">
                            RPi Packages
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/pages/reference-page.html" target="_blank">
                            Reference Page
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/pages/vim-cheat-sheet.html" target="_blank">
                            Vim Cheat Sheet
                        </a>
                    </li>
                </ul>
                </li>

                <li class="list-group-item"><h4><i class="fa fa-group fa-lg"></i><span class="icon-label">Social Media</span></h4>
                  <ul class="list-group" id="social">
                    <li class="list-group-item"><a href="https://github.com/jeffskinnerbox" target="_blank"><i
                            class="fa fa-github-square fa-lg"></i> Github
                    </a></li>
                    <li class="list-group-item"><a href="https://twitter.com/jeffskinnerbox" target="_blank"><i
                            class="fa fa-twitter-square fa-lg"></i> Twitter
                    </a></li>
                    <li class="list-group-item"><a href="https://linkedin.com/in/jeffreyirland" target="_blank"><i
                            class="fa fa-linkedin-square fa-lg"></i> Linkedin
                    </a></li>
                  </ul>
            </li>

            <li class="list-group-item"><a href="http://jeffskinnerbox.me/pages/this-blog-is-powered-by.html"><h4><i class="fa fa-rocket fa-lg"></i><span class="icon-label">This Blog Powered By</span></h4></a>

        </ul>
    </section>

</aside>        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">This Blog Powered By 
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>, And
            <a href="/pages/this-blog-is-powered-by.html" target="_blank">Other Things</a>.
            <p>
            <a href="http://opensource.org/">
                <img src="/images/logos/open_source_logo.png" alt="Open Source Logo" title="The Open Source Initiative (OSI) is a non-profit corporation with global scope formed to educate about and advocate for the benefits of open source, and to build bridges among different constituencies in the open source community. The OSI maintains the Open Source Definition and the list of Open Source Initiative-approved licenses." height="40px" width="40px">
            </a>
            <small>
                All my work is
                <a href="http://opensource.org/licenses/MIT/" target="_blank">MIT licensed, Open, and Free</a>,
                except where indicated otherwise.
            </small>
            </p>
         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://code.jquery.com/jquery.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://jeffskinnerbox.me/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://jeffskinnerbox.me/theme/js/respond.min.js"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            if (!window.jXHR) {
                var jxhr = document.createElement('script');
                jxhr.type = 'text/javascript';
                jxhr.src = 'http://jeffskinnerbox.me/theme/js/jXHR.js';
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(jxhr, s);
            }

            github.showRepos({
                user: 'jeffskinnerbox',
                count: 5,
                skip_forks: true,
                target: '#gh_repos'
            });
        });
    </script>
    <script src="http://jeffskinnerbox.me/theme/js/github.js" type="text/javascript"></script>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'jeffskinnerbox'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-43272292-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();

    </script>
</body>
</html>