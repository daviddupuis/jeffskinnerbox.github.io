<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>The Simplest XBee Network - Jeff's Skinner Box</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link href="http://jeffskinnerbox.me/favicon.ico" rel="icon">

    <!-- Open Graph tags -->
            <meta property="og:type" content="article"/>
            <meta property="og:title" content="The Simplest XBee Network"/>
            <meta property="og:url" content="http://jeffskinnerbox.me/posts/2013/Mar/20/the-simplest-xbee-network/"/>
            <meta property="og:description" content="What I do here is list some simple, proof of concept programs that I used to create a network with a Arduino and Raspberry Pi (RPi) using XBee radios."/>

        <meta content='4b4ba976784eb9a97125d9e26149a667' name='RepostUsAPIKey' />
        <script src='http://1.rp-api.com/rjs/repostus.js' type='text/javascript'></script>

    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://jeffskinnerbox.me/theme/css/bootstrap.flatly.min.css" type="text/css"/>

    <!-- Font Awesome and Google Fonts -->
    <link href="http://jeffskinnerbox.me/theme/css/font-awesome.min.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Knewave' rel='stylesheet' type='text/css'>

    <link href="http://jeffskinnerbox.me/theme/css/pygments/native.css" rel="stylesheet">
        <link href="http://jeffskinnerbox.me/theme/css/typogrify.css" rel="stylesheet">
    <link rel="stylesheet" href="http://jeffskinnerbox.me/theme/css/style.css" type="text/css"/>

</head>

<body>
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://jeffskinnerbox.me/" style="font-family: Knewave, cursive; font-size: 48px; color: #FFFFFF">
Jeff's Skinner Box&nbsp;            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="http://jeffskinnerbox.me/pages/about-me.html">
                             About&nbsp;Me
                          </a></li>
                    <li><a href="/index.html">Blog</a></li>
                    <li><a href="/pages/open-notebook.html">Open Notebook</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="http://jeffskinnerbox.me/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
<!-- GitHub Ribbon - https://github.com/blog/273-github-ribbons -->
<a href="https://github.com/jeffskinnerbox/jeffskinnerbox.github.io/tree/source" target="_blank">
    <img style="position: absolute; top: 0; left: 0; border: 0;" src="https://github-camo.global.ssl.fastly.net/82b228a3648bf44fc1163ef44c62fcc60081495e/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f6c6566745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_left_red_aa0000.png">
</a>       <!-- GitHub Ribbon - https://github.com/blog/273-github-ribbons -->
</div> <!-- /.navbar -->

<div class="container">
    <div class="row">
        <div class="col-sm-9">

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://jeffskinnerbox.me/posts/2013/Mar/20/the-simplest-xbee-network/"
                       rel="bookmark"
                       title="Permalink to The Simplest XBee Network">
                        The Simplest XBee&nbsp;Network
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2013-03-20T00:01:00"> Wednesday  March 20, 2013</time>
    </span>



&nbsp;&nbsp;&nbsp;
<i class="fa fa-tags fa-lg"></i>
    <a class="btn btn-default btn-xs" href="http://jeffskinnerbox.me/tag/xbee/">XBee</a>
    
</footer><!-- /.post-info -->                    </div>
<!-- Repost button -->
<!-- For more information - http://www.repost.us/ -->
<a class='rpuRepostUsButton' href='https://secure.repost.us/syndicate/create'>
    <img alt='Repost This' title='Repost this article to your website' src='http://static.1.rp-api.com/buttons/repostus_bttn_shrt_embed.png'/>
</a>                </div>
                <p><a href="http://jeffskinnerbox.files.wordpress.com/2013/03/2013-03-20-21-14-05.jpg">
    <img class="img-rounded" style="margin: 0px 8px; float: left" alt="SAMSUNG" src="/images/2013-03-20-21-14-05.jpg?w=500" width="250" height="188" />
</a>
As I continue my investigation of the XBee radio, I&#8217;m impressed by the functionality compressed into the the small package, but I have been frustrated by one fact.  It has been a hard road to understand the device and to make it do something useful.  There is a confusing mass of commands and options that can be used.  To make things more difficult for me, it is my nature to study my subject at depth, and understand it well, before I commit myself to a project.  The XBee radios are proving to be a deep subject.  I have been struggling to get a simple 802.15.4 network up and working, at least one that is sufficiently complex to be useful for my&nbsp;needs.</p>
<p>I stumbled into the realization that I don&#8217;t have to master 802.15.4 and a large set of XBee commands to make a very simple but potentially useful network.  It&#8217;s a very basic observation about all radio devices like the XBee.  You see, at its core the XBee radio is  a <a href="http://en.wikipedia.org/wiki/Modem">modem</a>.  It encodes digital information, transmits its digits via electromagnetism, within a specific frequency band, to be received by another XBee, and  then converted back to digital information.  The use of packet data, the 802.15.4 protocol, and all the <span class="caps">AT</span> commands are layers on top of the XBee&#8217;s  modem capability.  The modem, the core communications sub-component, is a serial communications device with a Universal Asynchronous Receiver/Transmitter (<span class="caps">UART</span>) as examined in an <a href="http://jeffskinnerbox.wordpress.com/2012/12/05/raspberry-pi-serial-communication/">earlier blog</a>.  So why not we just treat the XBee radio as a simple serial communication device?  Drop the idea of packetized data and 802.15.4 protocol and just do&nbsp;raw serial communications.</p>
<p>While this simplification is seductive, it does come at a price. Data is packetized and transmitted using a protocol for very good reasons.  In data transmission you must consider the fact that data could get corrupted, you need to share the communication channel with others,  data streams may be long (if not endless) and need to be properly sequenced, communications is main between specific devices as apposed to just broadcasting, and many other concerns.  You give up much of this by doing raw serial communications but you&nbsp;gain simplicity.</p>
<p>What I plan to do here is list some simple, proof of concept programs that I used to create a network with a Arduino and Raspberry Pi (RPi) using XBee radios.  You could simply add additional devices, using the same code, and it will become a fully interconnected network (i.e. where every device can talk to every other devices directly).  While inferior to a 802.15.4 network on many levels, its quick to get operational and easy to debug.  Also keep in mind that this is built on the XBee radio,  but you could do this with most any radio which supports serial communications.
<h2>Architecture</h2>
I&#8217;ll be using a Arduino and a RPis for for my network, each with a XBee radio thought which they can communicate. I&#8217;ll establish terminal interface into each device so I can enter text for the device to transmit and the terminal will also show what messages where revived. All  terminals will be within windows on my <span class="caps">PC</span> using PuTTY, Xterm, or the Arduino&#8217;s serial monitor screen.
<h2>Initializing the XBee&nbsp;Radios</h2>
First step is to make sure all the XBee radios that will be part of your network are properly configured.  Specifically, you need to make sure the <span class="caps">PAN</span> <span class="caps">ID</span> and Channel <span class="caps">ID</span> of the XBee radio&#8217;s are identical.  To accomplish this, I used the <code>XBeeTerm.py</code> utility I posted in my earlier blog titled <a href="http://jeffskinnerbox.wordpress.com/2013/01/30/configuration-utilities-for-xbee-radios/">Configuration Utilities for XBee Radios</a>.  I&#8217;m going to setup my network with two XBee radios (but you can use as many as you wish) and I used the configuration file below on both&nbsp;radios:</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"># To remove comments, white spaces, and blank lines, use the following:
#       sed &#39;/^#/d; s/\([^$]\)#.*/\1/&#39; Modem-Device.txt | sed &#39;s/[ \t]*$//&#39; &amp;gt; modemd.txt
# Run this script to configure the XBee radio using the following:
#       ./XBeeTerm.py modemd.txt
#
baudrate 9600       # (XBeeTerm command) set the baudrate used to comm. with the XBee
serial /dev/ttyUSB0 # (XBeeTerm command) serial device which has the XBee radio
+++             # (XBee command) enter AT command mode on the XBee
ATRE            # (XBee command) restore XBee to factory settings
ATID B000       # (XBee command) Set the PAN ID to eight byte hex (all XBee&#39;s must have this same value)
ATCH 0E         # (XBee command) set the Channel ID to a four byte hex (all XBee&#39;s must have same value)
ATPL 0          # (XBee command) power level at which the RF module transmits (0 lowest / 4 highest)
ATWR            # (XBee command) write all the changes to the XBee non-volatile memory
ATFR            # (XBee command) reboot XBee radio
exit            # (XBeeTerm command) exit python shell
</pre></div>


<h2>Arduino&nbsp;Configuration</h2>

<p>The sketch on the Arduino is very simple. Called <code>XBeeModem.ino</code> and is listed&nbsp;blow:</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span style="color: #0099FF; font-style: italic">/*</span>
<span style="color: #0099FF; font-style: italic">    The XBee devise should be connected to the Arduino Uno in the following way:</span>
<span style="color: #0099FF; font-style: italic">        XBee RX is connected to Arduino TX pin 3</span>
<span style="color: #0099FF; font-style: italic">        XBee TX is connected to Ardunio RX pin 2</span>
<span style="color: #0099FF; font-style: italic">        XBee +5V and Ground pins connect to the same on the Arduino</span>
<span style="color: #0099FF; font-style: italic"> */</span>

<span style="color: #009999">#define RXPIN 2</span>
<span style="color: #009999">#define TXPIN 3</span>
<span style="color: #009999">#define BAUDRATE 9600</span>

<span style="color: #009999">#include</span>

SoftwareSerial XBeeSerial <span style="color: #555555">=</span>  SoftwareSerial(RXPIN, TXPIN);

<span style="color: #007788; font-weight: bold">void</span> <span style="color: #CC00FF">setup</span>()
{
    pinMode(<span style="color: #FF6600">13</span>, OUTPUT);

    <span style="color: #0099FF; font-style: italic">// Set the data rate for the hardware Serial port</span>
    <span style="color: #0099FF; font-style: italic">// and post a message stating so on the Arduino&#39;s Serial Monitor.</span>
    Serial.begin(BAUDRATE);
    Serial.println(<span style="color: #CC3300">&quot;Arduino #1 up and running.&quot;</span>);

    <span style="color: #0099FF; font-style: italic">// Set the data rate for the SoftwareSerial port and</span>
    <span style="color: #0099FF; font-style: italic">// send a message out stating so via the XBee to the other devices.</span>
    XBeeSerial.begin(BAUDRATE);
    XBeeSerial.println(<span style="color: #CC3300">&quot;Arduino #1 up and running.&quot;</span>);
}

<span style="color: #007788; font-weight: bold">void</span> <span style="color: #CC00FF">loop</span>()
{
    <span style="color: #007788; font-weight: bold">char</span> c;

    <span style="color: #0099FF; font-style: italic">// Read data arriving from the XBee and send to Arduino Serial Monitor.</span>
    <span style="color: #006699; font-weight: bold">if</span> (XBeeSerial.available()) {
        Serial.print((<span style="color: #007788; font-weight: bold">char</span>)XBeeSerial.read());
    }

    <span style="color: #0099FF; font-style: italic">// Capture data typed at the Arduino Serial Monitor, echo the data to the Serial Monitor,</span>
    <span style="color: #0099FF; font-style: italic">// and send that data via the XBee.</span>
    <span style="color: #006699; font-weight: bold">if</span> (Serial.available()) {
        c <span style="color: #555555">=</span> (<span style="color: #007788; font-weight: bold">char</span>)Serial.read();
        Serial.print(c);
        XBeeSerial.print(c);
    }

    delay(<span style="color: #FF6600">100</span>);
}
</pre></div>


<h2>Raspberry Pi&nbsp;Configuration</h2>

<p>The Python program on the RPi is also very simple, except for one point.  Linux I/O reads will <a href="http://www.linux-mag.com/id/308/">block </a>if there are no characters to read.  You must &#8220;turn-off&#8221; blocking.  The program is called <code>XBeeModem.py</code> and is listed&nbsp;blow:</p>
<p><script src="https://gist.github.com/jeffskinnerbox/6663336.js"></script></p>

<h2>Closing</h2>

<p>It doesn&#8217;t get much simpler than this. With a little work, you might make something useful out of this technique but its very limited in the types of problems that it could handle. Never the less, it was a good diversion for me to clear my mind. Now back to the XBee&#8217;s core capabilites, the 802.15.4 protocol, and the other&nbsp;minutia!</p>
            </div>
            <!-- /.entry-content -->
    <hr />
    <section class="comments" id="comments">
        <h2>Comments</h2>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'jeffskinnerbox'; // required: replace example with your forum shortname
            var disqus_identifier = 'the-simplest-xbee-network';
            var disqus_url = 'http://jeffskinnerbox.me/posts/2013/Mar/20/the-simplest-xbee-network/';
            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3 well well-sm" id="sidebar">

<aside>
    <section>
        <ul class="list-group list-group-flush">
                <div style="text-align: center;">
                    <h3><a href="http://jeffskinnerbox.me/pages/about-me.html" style="font-family: Knewave, cursive; font-size: 18;">My Electronics Projects And Other Diversions</a>
                    <img class="img-rounded" src="http://jeffskinnerbox.me/extra/frustrated-engineer.jpg" alt="Side Bar Picture" height="100%" width="100%">
                </div>

            <li class="list-group-item"><a href="http://jeffskinnerbox.me/categories.html"><h4><i class="fa fa-folder-open fa-lg"></i><span class="icon-label">Categories</span></h4></a>
            </li>

            <li class="list-group-item"><a href="http://jeffskinnerbox.me/tags.html"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
            </li>    

            <li class="list-group-item"><a href="http://jeffskinnerbox.me/index.html"><h4><i class="fa fa-file-text fa-lg"></i><span class="icon-label">Recent Posts</span></h4></a>
            </li>

            <li class="list-group-item"><a href="http://jeffskinnerbox.me/pages/open-notebook.html"><h4><i class="fa fa-book fa-lg"></i><span class="icon-label">Open Notebook</span></h4></a>

            <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
                <ul class="list-group" id="links">
                    <li class="list-group-item">
                        <a href="/pages/scratch-pad.html" target="_blank">
                            Scratch Pad
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/pages/linux-python-packages-for-my-raspberry-pi.html" target="_blank">
                            RPi Packages
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/pages/reference-page.html" target="_blank">
                            Reference Page
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/pages/vim-cheat-sheet.html" target="_blank">
                            Vim Cheat Sheet
                        </a>
                    </li>
                </ul>
                </li>

                <li class="list-group-item"><h4><i class="fa fa-group fa-lg"></i><span class="icon-label">Social Media</span></h4>
                  <ul class="list-group" id="social">
                    <li class="list-group-item"><a href="https://github.com/jeffskinnerbox" target="_blank"><i
                            class="fa fa-github-square fa-lg"></i> Github
                    </a></li>
                    <li class="list-group-item"><a href="https://twitter.com/jeffskinnerbox" target="_blank"><i
                            class="fa fa-twitter-square fa-lg"></i> Twitter
                    </a></li>
                    <li class="list-group-item"><a href="https://linkedin.com/in/jeffreyirland" target="_blank"><i
                            class="fa fa-linkedin-square fa-lg"></i> Linkedin
                    </a></li>
                  </ul>
            </li>

            <li class="list-group-item"><a href="http://jeffskinnerbox.me/pages/this-blog-is-powered-by.html"><h4><i class="fa fa-rocket fa-lg"></i><span class="icon-label">This Blog Powered By</span></h4></a>

        </ul>
    </section>

</aside>        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">This Blog Powered By 
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>, And
            <a href="/pages/this-blog-is-powered-by.html" target="_blank">Other Things</a>.
            <p>
            <a href="http://opensource.org/">
                <img src="/images/logos/open_source_logo.png" alt="Open Source Logo" title="The Open Source Initiative (OSI) is a non-profit corporation with global scope formed to educate about and advocate for the benefits of open source, and to build bridges among different constituencies in the open source community. The OSI maintains the Open Source Definition and the list of Open Source Initiative-approved licenses." height="40px" width="40px">
            </a>
            <small>
                All my work is
                <a href="http://opensource.org/licenses/MIT/" target="_blank">MIT licensed, Open, and Free</a>,
                except where indicated otherwise.
            </small>
            </p>
         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://code.jquery.com/jquery.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://jeffskinnerbox.me/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://jeffskinnerbox.me/theme/js/respond.min.js"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            if (!window.jXHR) {
                var jxhr = document.createElement('script');
                jxhr.type = 'text/javascript';
                jxhr.src = 'http://jeffskinnerbox.me/theme/js/jXHR.js';
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(jxhr, s);
            }

            github.showRepos({
                user: 'jeffskinnerbox',
                count: 5,
                skip_forks: false,
                target: '#gh_repos'
            });
        });
    </script>
    <script src="http://jeffskinnerbox.me/theme/js/github.js" type="text/javascript"></script>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'jeffskinnerbox'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-43272292-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();

    </script>
</body>
</html>